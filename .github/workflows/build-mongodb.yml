name: Build MongoDB

on:
  schedule:
    - cron: '0 4 * * *'
  repository_dispatch:
    types: [php-updated]
  workflow_dispatch:
    inputs:
      php_versions:
        description: 'PHP versions (comma-separated, empty=all)'
        type: string
      force_build:
        description: 'Force build'
        type: boolean
        default: false

permissions:
  contents: write

jobs:
  build:
    uses: ./.github/workflows/_build-extension.yml
    with:
      extension: mongodb
      packagist: mongodb/mongodb-extension
      display_name: MongoDB
      brew_deps: "openssl@3"
      php_versions: ${{ inputs.php_versions || github.event.client_payload.php_versions || '' }}
      force_build: ${{ inputs.force_build || false }}
    secrets: inherit
